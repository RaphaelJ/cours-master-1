! Traffic from the Internet to the sub-network.
ip access-list extended hawk-firewall-internet-in
    ! Routing traffic
    permit ospf host eagle.run.montefiore.ulg.ac.be host hawk.run.montefiore.ulg.ac.be
    permit ospf host owl.run.montefiore.ulg.ac.be host hawk.run.montefiore.ulg.ac.be

    ! Accepts unicast ICMP traffic
    permit icmp 139.165.222.0 255.255.255.0 host hornet.run.montefiore.ulg.ac.be
    permit icmp 139.165.222.0 255.255.255.0 host scarab.run.montefiore.ulg.ac.be

    ! Accepts HTTP traffic to hornet
    permit tcp any host hornet.run.montefiore.ulg.ac.be eq www

    ! Accepts SSH
    permit tcp 139.165.222.0 255.255.255.0 139.165.222.160 255.255.255.224 eq 22

    ! Accepts DHCP, DNS and LDAP UDP responses from ant
    permit udp host ant.run.montefiore.ulg.ac.be 139.165.222.160 255.255.255.224 eq 68
    permit udp host ant.run.montefiore.ulg.ac.be eq 53 139.165.222.160 255.255.255.224
    permit udp host ant.run.montefiore.ulg.ac.be eq 389 139.165.222.160 255.255.255.224

    ! Accepts any established TCP connections.
    permit tcp any any established

    deny log

! Traffic from the sub-network to the Internet.
ip access-list extended hawk-firewall-lan-in
    ! Accepts DNS requests to ant
    permit udp 139.165.222.160 255.255.255.224 host ant.run.montefiore.ulg.ac.be eq 53

    ! Accepts ICMP traffic
    permit icmp 139.165.222.160 255.255.255.224 any

    ! Accepts LDAP traffic to ant
    permit tcp 139.165.222.160 255.255.255.224 host ant.run.montefiore.ulg.ac.be eq 389
    permit udp 139.165.222.160 255.255.255.224 host ant.run.montefiore.ulg.ac.be eq 389

    ! Accepts HTTP/HTTPS traffic to the Internet
    permit tcp 139.165.222.160 255.255.255.224 any eq www
    permit tcp 139.165.222.160 255.255.255.224 any eq 443

    ! Accepts SSH to 139.165.0.0/16 
    permit tcp 139.165.222.160 255.255.255.224 139.165.0.0 255.255.0.0 eq 22

    ! Accepts any established TCP connections.
    permit tcp any any established

    deny log

! Prevents SYN flooding by intercepting TCP handshakes.
! http://www.cisco.com/c/en/us/td/docs/ios/12_2/security/configuration/guide/fsecur_c/scfdenl.html
ip tcp intercept list hawk-firewall-internet-in
ip tcp intercept mode intercept

! http://www.cisco.com/c/en/us/support/docs/ip/access-lists/26448-ACLsamples.html
